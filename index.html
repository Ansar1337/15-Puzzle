<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fifteen game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="game_container">

    <!--Шапка-->
    <header class="game_header">
        <div class="info_board">
            <span>Ходы:
            <span id="moves">0</span>
            </span>
            <span>Время:
            <span id="time">00:00</span>
            </span>
        </div>
        <button id="leaderboard-btn">Топ-15 игроков</button>
    </header>

    <!--Игровая зона-->
    <div class="screen_container" id="screen_main">

    </div>

    <!--Кнопки-->
    <div class="game_controls">
        <button id="start_restart_btn">Старт</button>
        <button id="reset_btn">Сброс</button>
    </div>

    <button id="timer_start">Timer_Start</button>
    <button id="timer_pause">Timer_Pause</button>
    <button id="timer_stop">Timer_Stop</button>

</div>
<!--<script src="script2.js"></script>-->
<!--BUG
0. При повторном нажатии на кнопку старт запускается новый таймер
1. Паузнотое время должно учитываться при повторном нажатии на кнопку старт
1.
2. -->
<script>
    class Timer {
        startTime = Date.now();
        timeInterval;
        paused = false;
        running = false;
        time = 0;

        constructor() {

        }

        startTimer() {
            if (this.running) {
                console.log("Таймер уже работает");
                return;
            }
            this.running = true;
            this.paused = false;

            const startTime = Date.now();

            this.timeInterval = setInterval(() => {
                // const currentTime2 = this.time + this.startTime;
                const currentTime = Date.now();
                const passedTime = new Date(currentTime - startTime);

                const minutes = (passedTime.getUTCMinutes()).toString().padStart(2, '0');
                const seconds = (passedTime.getUTCSeconds()).toString().padStart(2, '0');

                console.log(document.getElementById("time").textContent = `${minutes}:${seconds}`);
            }, 1000);
        }

        pauseTimer() {
            this.paused = true;
            this.running = false;
            clearInterval(this.timeInterval);
            const currentTime = new Date();
            this.time = currentTime - this.startTime;
        }

        stopTimer() {
            clearInterval(this.timeInterval);
        }
    }

    const timer_start = document.getElementById('timer_start');
    const timer_pause = document.getElementById('timer_pause');
    const timer_stop = document.getElementById('timer_stop');

    const timeObject = new Timer();

    timer_start.addEventListener('click', () => {
        timeObject.startTimer();

    });

    timer_pause.addEventListener('click', () => {
        timeObject.pauseTimer();
    });

    timer_stop.addEventListener('click', () => {
        timeObject.stopTimer();
    });

    function startTimer() {

        const startTime = new Date();

        return setInterval(() => {
            const currentTime = new Date();
            const passedTime = new Date(currentTime - startTime);

            const minutes = (passedTime.getUTCMinutes()).toString().padStart(2, '0');
            const seconds = (passedTime.getUTCSeconds()).toString().padStart(2, '0');

            console.log(document.getElementById("time").textContent = `${minutes}:${seconds}`);
        }, 1000);
    }
</script>

</body>
</html>